{% extends 'base.html' %}

{% block titulo %}
Crear Venta
{% endblock titulo %}
{% block contenido %}
<div class="card shadow mb-4">
    <div class="card-header py-3">
        <input type="text" id="producto">
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table-bordered" width="100%" cellspacing="0">
                <thead>
                    <tr>
                        <th>Cantidad</th>
                        <th>Producto</th>
                        <th>Precio</th>
                        <th>Descuento</th>
                        <th>Subtotal</th>
                        <th>Total</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id='list-producto'>
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock contenido %}
{% block js %}
<script>
    const agregarProducto = (producto)=> {
        let descuento = 0
        const total = producto.cantidad * producto.precio
        const totalDescuento = (descuento/100) * total
        const totalFinal = total - totalDescuento
        const fila = $('<tr></tr>')

        fila.append(`<td><input type="text" value=${producto.cantidad} min="1" max=${producto.existencia}></td>`)
        fila.append(`<td>${producto.nombre}</td>`)
        fila.append(`<td>$${producto.precio}</td>`)
        fila.append(``)
    }
    $('#producto').autocomplete({
        source: "{% url 'autocomplete_producto' %}",
        select: function(event,ui){
            const id = ui.item.id
            const nombre = ui.item.label
            const precio = ui.item.precio
            const existencia = ui.item.existencia

            let producto = {
                id: id,
                nombre: nombre,
                precio: precio,
                existencia: existencia,
                cantidad: 1
            }
        } 
    })
</script>
{% endblock js %}